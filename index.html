<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bububu party - Detská Halloweenska Párty</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Eater&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        .font-halloween {
            font-family: 'Eater', cursive;
        }
        .text-glow {
            text-shadow: 0 0 8px rgba(251, 146, 60, 0.7), 0 0 20px rgba(234, 88, 12, 0.5);
        }
        .bg-pattern {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%239ca3af' fill-opacity='0.1'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 bg-pattern">

    <div id="app">
        <!-- Header & Hero -->
        <header class="relative overflow-hidden">
            <div class="container mx-auto px-6 py-24 md:py-32 text-center">
                <div class="absolute inset-0 bg-gradient-to-b from-gray-900 via-gray-900 to-transparent z-0"></div>
                <div class="relative z-10">
                    <h1 class="text-6xl md:text-8xl font-halloween text-orange-400 text-glow tracking-wider">Bububu party</h1>
                    <p class="text-xl md:text-2xl mt-4 max-w-2xl mx-auto text-gray-300">Najzábavnejšia halloweenska párty pre všetky deti!</p>
                    
                    <!-- Countdown Timer Section -->
                    <section class="my-16 md:my-24">
                        <h2 class="text-4xl font-halloween text-center text-purple-400 mb-8">Čas sa kráti...</h2>
                        <div v-if="!isPartyTime" class="flex justify-center items-center space-x-4 md:space-x-8 text-center">
                            <div>
                                <div class="text-4xl md:text-6xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-orange-400">{{ days }}</div>
                                <div class="text-sm uppercase text-gray-400 mt-2">Dní</div>
                            </div>
                            <div class="text-4xl md:text-6xl text-gray-600">:</div>
                            <div>
                                <div class="text-4xl md:text-6xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-orange-400">{{ hours }}</div>
                                <div class="text-sm uppercase text-gray-400 mt-2">Hodín</div>
                            </div>
                            <div class="text-4xl md:text-6xl text-gray-600">:</div>
                            <div>
                                <div class="text-4xl md:text-6xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-orange-400">{{ minutes }}</div>
                                <div class="text-sm uppercase text-gray-400 mt-2">Minút</div>
                            </div>
                            <div class="text-4xl md:text-6xl text-gray-600">:</div>
                            <div>
                                <div class="text-4xl md:text-6xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-orange-400">{{ seconds }}</div>
                                <div class="text-sm uppercase text-gray-400 mt-2">Sekúnd</div>
                            </div>
                        </div>
                        <div v-else class="text-3xl font-bold text-orange-400">Párty práve začala!</div>
                    </section>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto px-6">
            <!-- Event Details Section - Iterates over the computed property -->
            <section id="miesta-konania" class="bg-gray-800/50 backdrop-blur-sm rounded-2xl shadow-2xl p-8 md:p-12 my-16 md:my-24 ring-1 ring-white/10" v-for="event in eventsWithCalendarLinks" :key="event.name">
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 items-center">
                    <div class="lg:col-span-2">
                        <h2 class="text-4xl font-halloween text-orange-400 mb-4">{{ event.name }}</h2>
                        <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6 text-lg">
                            <div class="flex items-center">
                                <svg class="w-6 h-6 mr-3 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                <span>{{ event.date }}</span>
                            </div>
                            <div class="flex items-center">
                                <svg class="w-6 h-6 mr-3 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                <span>{{ event.location }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-center">
                        <a :href="event.calendarLink" :download="event.icsFilename" class="bg-purple-600 hover:bg-purple-500 text-white font-bold py-3 px-6 rounded-full text-lg transition duration-300 ease-in-out transform hover:scale-105 shadow-lg shadow-purple-500/30 inline-block">
                            Pridať do kalendára
                        </a>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-transparent mt-16 md:mt-24 pb-8">
            <div class="container mx-auto text-center text-gray-500">
            </div>
        </footer>
    </div>

    <script>
        new Vue({
            el: '#app',
            data: {
                targetDate: new Date("Oct 30, 2025 13:00:00").getTime(),
                days: '00',
                hours: '00',
                minutes: '00',
                seconds: '00',
                isPartyTime: false,
                countdownInterval: null,
                events: [
                    {
                        name: 'Aupark Bratislava',
                        location: 'Aupark, Einsteinova 3541/18, 851 01 Petržalka',
                        date: 'Piatok, 24. Október 2025 | 13:00 - 19:00',
                        startTime: '2025-10-24T13:00:00',
                        endTime: '2025-10-24T19:00:00'
                    },
                    {
                        name: 'OC Central',
                        location: 'OC Central, Metodova 6, 821 08 Bratislava',
                        date: 'Štvrtok, 30. Október 2025 | 13:00 - 19:00',
                        startTime: '2025-10-30T13:00:00',
                        endTime: '2025-10-30T19:00:00'
                    }
                ]
            },
            computed: {
                eventsWithCalendarLinks() {
                    return this.events.map(event => {
                        const title = `Ples Príšer - ${event.name}`;
                        const description = 'Najmodernejšia a najzábavnejšia halloweenska párty pre všetky deti!';
                        const location = event.location;
                        
                        // Helper to format a local datetime string into the required iCalendar UTC format
                        const formatToIcsDate = (dateString) => {
                            const dt = new Date(dateString);
                            // .toISOString() returns UTC, then we remove dashes, colons, and milliseconds
                            return dt.toISOString().replace(/-|:|\.\d{3}/g, '');
                        };

                        const startDate = formatToIcsDate(event.startTime);
                        const endDate = formatToIcsDate(event.endTime);
                        const now = formatToIcsDate(new Date().toISOString());
                        
                        // Using a template literal to build the .ics file content.
                        // The line endings must be CRLF (\r\n) for the iCalendar standard.
                        const icsContent = [
                            'BEGIN:VCALENDAR',
                            'VERSION:2.0',
                            'PRODID:-//PlesPriser//SK',
                            'BEGIN:VEVENT',
                            `UID:${startDate}-${endDate}@plespriser.sk`, // Simple unique ID
                            `DTSTAMP:${now}`,
                            `DTSTART:${startDate}`,
                            `DTEND:${endDate}`,
                            `SUMMARY:${title}`,
                            `DESCRIPTION:${description}`,
                            `LOCATION:${location}`,
                            'END:VEVENT',
                            'END:VCALENDAR'
                        ].join('\r\n');

                        // Create the data URI for the .ics file
                        const calendarLink = `data:text/calendar;charset=utf8,${encodeURIComponent(icsContent)}`;
                        
                        // Create a filename for the download attribute
                        const icsFilename = `ples-priser-${event.name.toLowerCase().replace(/\s+/g, '-')}.ics`;

                        return {
                            ...event,
                            calendarLink: calendarLink,
                            icsFilename: icsFilename
                        };
                    });
                }
            },
            methods: {
                updateCountdown() {
                    const now = new Date().getTime();
                    const distance = this.targetDate - now;

                    if (distance < 0) {
                        this.isPartyTime = true;
                        clearInterval(this.countdownInterval);
                        return;
                    }

                    this.days = Math.floor(distance / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
                    this.hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
                    this.minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
                    this.seconds = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0');
                }
            },
            mounted() {
                this.updateCountdown(); // Call once immediately to avoid 1s delay
                this.countdownInterval = setInterval(this.updateCountdown, 1000);
            },
            beforeDestroy() {
                // Clean up the interval when the component is destroyed
                clearInterval(this.countdownInterval);
            }
        });
    </script>
</body>
</html>
