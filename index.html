<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ„ Zdobenie vianoÄnÃ©ho stromÄeku - DetskÃ¡ VianoÄnÃ¡ Akcia</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Berkshire+Swash&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      overflow-x: hidden;
    }
    .font-christmas {
      font-family: 'Berkshire Swash', cursive;
    }
    .text-shadow {
      text-shadow: 2px 2px 4px rgba(34, 197, 94, 0.4), 3px 3px 6px rgba(220, 38, 38, 0.5);
    }

    /* Snow */
    .snow-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 999;
    }
    .snowflake {
      position: absolute; top: -10px; color: white; opacity: 0.9;
      animation: fall linear infinite;
    }
    @keyframes fall {
      100% { transform: translateY(100vh) rotate(360deg); }
    }
    .snowflake::before {
      content: 'â„';
      font-size: 1.2rem;
    }

    /* Game Area */
    .game-area {
      position: relative;
      background: linear-gradient(to bottom right, #f0fdf4, #ffffff);
      border-radius: 25px;
      box-shadow: inset 0 0 25px rgba(255,255,255,0.6), 0 10px 20px rgba(0,0,0,0.08);
      overflow: hidden;
      /* --- NEW: Candy cane border --- */
      border: 12px solid transparent;
      border-image: repeating-linear-gradient(
        -45deg,
        #dc2626,
        #dc2626 15px,
        #fff 15px,
        #fff 30px
      ) 1;
    }
    .gift {
      position: absolute;
      font-size: 2.2rem;
      cursor: pointer;
      animation: pop 0.3s ease;
    }
    @keyframes pop {
      from { transform: scale(0); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .gift:hover {
      transform: scale(1.3) rotate(-10deg);
    }
    .game-ui {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.9);
      padding: 10px 30px;
      border-radius: 50px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      display: flex;
      gap: 40px;
      font-weight: 700;
      color: #14532d;
    }

    /* Buttons */
    .btn-primary {
      background-color: #dc2626;
      color: white;
      font-weight: bold;
      border-radius: 9999px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
    }
    .btn-primary:hover {
      background-color: #b91c1c;
      transform: scale(1.05);
    }
  </style>
</head>
<body class="bg-amber-50">
  <!-- More snowflakes added for a richer effect -->
  <div class="snow-container">
    <div class="snowflake" style="left:10%;animation-duration:8s;"></div>
    <div class="snowflake" style="left:15%;animation-duration:14s;animation-delay:-5s;"></div>
    <div class="snowflake" style="left:25%;animation-duration:10s;animation-delay:-3s;"></div>
    <div class="snowflake" style="left:30%;animation-duration:7s;animation-delay:-1s;"></div>
    <div class="snowflake" style="left:40%;animation-duration:12s;animation-delay:-2s;"></div>
    <div class="snowflake" style="left:55%;animation-duration:13s;animation-delay:-4s;"></div>
    <div class="snowflake" style="left:60%;animation-duration:9s;"></div>
    <div class="snowflake" style="left:75%;animation-duration:15s;animation-delay:-6s;"></div>
    <div class="snowflake" style="left:80%;animation-duration:11s;"></div>
    <div class="snowflake" style="left:90%;animation-duration:9s;animation-delay:-8s;"></div>
  </div>

  <div id="app" class="relative z-10">
    <!-- Updated header with decorations -->
    <header class="relative text-center py-28 bg-amber-50 overflow-hidden">
      <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/snow.png')] opacity-20"></div>
      <!-- NEW: Decorative elements -->
      <span class="absolute top-10 left-10 text-5xl opacity-40 transform -rotate-12 animate-pulse">ğŸŒŸ</span>
      <span class="absolute top-16 right-10 text-5xl opacity-40 transform rotate-12 animate-pulse">ğŸ””</span>
      <h1 class="text-7xl md:text-8xl font-christmas text-red-600 text-shadow"> Zdobenie StromÄeku</h1>
      <p class="text-xl md:text-2xl mt-4 text-gray-700"></p>
    </header>

    <main class="container mx-auto px-6 -mt-10">
      <!-- Game -->
      <section class="my-16 text-center">
        <div v-if="gameState === 'ready'">
          <!-- NEW: Decorative icons in title -->
          <h2 class="text-4xl font-christmas text-green-700 mb-4">ğŸ Zahraj sa vianoÄnÃº hru</h2>
          <p class="text-gray-700 mb-2">Klikni na vÅ¡etky darÄeky tak rÃ½chlo, ako dokÃ¡Å¾eÅ¡!</p>
          <p class="text-gray-500">NajlepÅ¡Ã­ Äas: <span class="font-bold">{{ formattedHighScore }}s</span></p>
          <button @click="startGame" class="btn-primary mt-5 px-10 py-4 text-xl shadow-lg">
            Å tart ğŸ…
          </button>
        </div>

        <div v-if="gameState === 'playing'" class="game-area h-[400px] mt-10">
          <div class="game-ui">
            <div>â±{{ formattedTime }}s</div>
            <div>ğŸ {{ gifts.length }}</div>
          </div>
          <div v-for="(gift, index) in gifts" 
            :key="gift.id" 
            class="gift" 
            :style="{ top: gift.top + '%', left: gift.left + '%' }"
            @click="collectGift(index)">ğŸ</div>
        </div>

        <div v-if="gameState === 'finished'" class="mt-10">
          <h2 class="text-4xl font-christmas text-green-700">Gratulujeme!</h2>
          <p v-if="isNewHighScore" class="text-2xl text-red-600 font-bold mt-2">ğŸ‰ NovÃ½ rekord!</p>
          <p class="mt-3 text-xl">Tvoj Äas: <span class="text-4xl font-bold">{{ finalTime }}s</span></p>
          <p class="text-gray-600 mt-2">NajlepÅ¡Ã­ Äas: <span class="font-bold">{{ formattedHighScore }}s</span></p>
          <button @click="startGame" class="btn-primary mt-5 px-8 py-3 text-lg shadow-lg">HraÅ¥ znova </button>
        </div>
      </section>
      
      <!-- NEW: Christmas Garland Divider -->

      <!-- Events -->
      <section v-for="event in eventsWithCalendarLinks" :key="event.name" class="bg-white/70 backdrop-blur-sm rounded-3xl shadow-xl p-8 md:p-12 my-12 ring-1 ring-black/5 transition-all hover:shadow-2xl hover:scale-[1.01]">
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 items-center">
          <div class="lg:col-span-2">
            <!-- NEW: Decorative icons in title -->
            <h2 class="text-4xl font-christmas text-green-700 mb-4">{{ event.name }}</h2>
            <div class="space-y-2 text-lg text-gray-700">
              <p>ğŸ“… {{ event.date }}</p>

            </div>
          </div>
          <div class="text-center">
            <a :href="event.calendarLink" :download="event.icsFilename" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-full text-lg transition transform hover:scale-105 shadow-lg shadow-green-400/40 inline-block">PridaÅ¥ do kalendÃ¡ra
            </a>
          </div>
        </div>
      </section>
    </main>

    <footer class="text-center text-gray-500 py-10">
    </footer>
  </div>

  <!-- Vue script -->
  <script>
    new Vue({
      el: '#app',
      data: {
        events: [
          { name: 'Zdobenie stromÄeku v Detskom kÃºtiku', date: 'Sobota, 06. December 2025 | 15:00 - 19:00', startTime: '2025-12-06T15:00:00', endTime: '2025-12-06T19:00:00' }
        ],
        gameState: 'ready',
        gifts: [],
        totalGifts: 10,
        timer: null,
        timeElapsed: 0,
        finalTime: '',
        highScore: null,
        isNewHighScore: false
      },
      computed: {
        eventsWithCalendarLinks() {
          return this.events.map(event => {
            const title = `Zdobenie stromÄeku - ${event.name}`;
            const description = 'OslÃ¡vte s nami MikulÃ¡Å¡a';
            const formatToIcsDate = d => new Date(d).toISOString().replace(/-|:|\.\d{3}/g, '');
            const startDate = formatToIcsDate(event.startTime);
            const endDate = formatToIcsDate(event.endTime);
            const now = formatToIcsDate(new Date());
            const ics = `BEGIN:VCALENDAR\r\nVERSION:2.0\r\nPRODID:-//ZdobenieStromceku//SK\r\nBEGIN:VEVENT\r\nUID:${startDate}-${endDate}@zdobeniestromceku.sk\r\nDTSTAMP:${now}\r\nDTSTART:${startDate}\r\nDTEND:${endDate}\r\nSUMMARY:${title}\r\nDESCRIPTION:${description}\r\nEND:VEVENT\r\nEND:VCALENDAR`;
            const calendarLink = `data:text/calendar;charset=utf8,${encodeURIComponent(ics)}`;
            const icsFilename = `zdobenie-stromceku-${event.name.toLowerCase().replace(/\s+/g, '-')}.ics`;
            return { ...event, calendarLink, icsFilename };
          });
        },
        formattedTime() {
          const s = Math.floor(this.timeElapsed / 1000);
          return String(s).padStart(2, '0');
        },
        formattedHighScore() {
          if (this.highScore === null) return '--.--';
          return this.formatTime(this.highScore);
        }
      },
      methods: {
        formatTime(ms) {
          const totalSeconds = Math.floor(ms / 1000);
          const milliseconds = String(ms % 1000).padStart(3, '0').slice(0, 2);
          return `${String(totalSeconds).padStart(2, '0')}.${milliseconds}`;
        },
        startGame() {
          this.isNewHighScore = false;
          this.gameState = 'playing';
          this.timeElapsed = 0;
          this.generateGifts();
          this.startTimer();
        },
        generateGifts() {
          this.gifts = Array.from({ length: this.totalGifts }, (_, i) => ({
            id: i,
            top: Math.random() * 80 + 10,
            left: Math.random() * 90 + 5
          }));
        },
        collectGift(i) {
          this.gifts.splice(i, 1);
          if (!this.gifts.length) this.endGame();
        },
        startTimer() {
          clearInterval(this.timer);
          const start = Date.now();
          this.timer = setInterval(() => (this.timeElapsed = Date.now() - start), 10);
        },
        endGame() {
          clearInterval(this.timer);
          this.finalTime = this.formatTime(this.timeElapsed);
          if (this.highScore === null || this.timeElapsed < this.highScore) {
            this.highScore = this.timeElapsed;
            localStorage.setItem('giftGameHighScore', this.highScore);
            this.isNewHighScore = true;
          }
          this.gameState = 'finished';
        }
      },
      mounted() {
        const saved = localStorage.getItem('giftGameHighScore');
        if (saved) this.highScore = parseInt(saved);
      }
    });
  </script>
</body>
</html>
